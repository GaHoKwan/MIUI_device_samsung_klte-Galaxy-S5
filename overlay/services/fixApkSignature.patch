From cc02251498d7f32eb35797643ce63fa7fcda7619 Mon Sep 17 00:00:00 2001
From: GaHoKwan <kwangaho@gmail.com>
Date: Mon, 18 Jan 2016 12:35:54 -0500
Subject: [PATCH] fixApkSignature

---
 .../android/server/pm/PackageManagerService.smali  | 36 ++++++++++++++++++++++
 1 file changed, 36 insertions(+)

--- a/services/smali/com/android/server/pm/PackageManagerService.smali
+++ b/services/smali/com/android/server/pm/PackageManagerService.smali
@@ -20445,6 +20445,22 @@

     iget-object v4, v0, Landroid/content/pm/PackageParser$Package;->mSignatures:[Landroid/content/pm/Signature;

+    const-string v0, "com.miui.video"
+
+    invoke-virtual {v0, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v0
+
+    if-nez v0, :cond_0
+
+    const-string v0, "com.android.browser"
+
+    invoke-virtual {v0, v12}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v0
+
+    if-nez v0, :cond_0
+
     invoke-static {v1, v4}, Lcom/android/server/pm/PackageManagerService;->compareSignatures([Landroid/content/pm/Signature;[Landroid/content/pm/Signature;)I

     move-result v1
@@ -34162,6 +34178,27 @@
     .prologue
     const/4 v0, 0x0

+
+    const-string v1, "com.miui.video"
+
+    iget-object v3, p2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
+
+    invoke-virtual {v1, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v1
+
+    if-nez v1, :cond_1
+
+    const-string v1, "com.android.browser"
+
+    iget-object v3, p2, Landroid/content/pm/PackageParser$Package;->packageName:Ljava/lang/String;
+
+    invoke-virtual {v1, v3}, Ljava/lang/String;->equals(Ljava/lang/Object;)Z
+
+    move-result v1
+
+    if-nez v1, :cond_1
+
     iget-object v1, p1, Lcom/android/server/pm/PackageSetting;->signatures:Lcom/android/server/pm/PackageSignatures;

     iget-object v1, v1, Lcom/android/server/pm/PackageSignatures;->mSignatures:[Landroid/content/pm/Signature;
--
2.5.0
